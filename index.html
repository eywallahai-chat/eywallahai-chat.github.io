<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Eywallah AI Orion 1</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css" />
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .scrollbar-thin::-webkit-scrollbar { width: 8px; }
    .scrollbar-thin::-webkit-scrollbar-track { background: #1a1a1a; border-radius: 10px; }
    .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #00FFB3; border-radius: 10px; border: 2px solid #1a1a1a; }
    .sidebar {
      width: 12.5vw; min-width: 200px; background-color: #1a1a1a; color: #f2f2f2; padding: 20px;
      box-sizing: border-box; transition: transform 0.3s ease-in-out; position: fixed; top: 0; left: 0;
      height: 100%; z-index: 50; transform: translateX(-100%);
    }
    .sidebar.open { transform: translateX(0); }
    #menuToggleBtn {
      position: fixed; top: 20px; left: 20px; z-index: 60; background: none; border: none; cursor: pointer;
      font-size: 24px; color: #f2f2f2; padding: 0;
    }
    @media (min-width: 1024px) {
      .sidebar { position: static; transform: translateX(0); min-width: 200px; max-width: 300px; }
      #menuToggleBtn { display: none; }
    }
    .sidebar-buttons button { width: 100%; margin-bottom: 10px; background-color: #2a2a2a; color: #f2f2f2; font-weight: 500; }
    .sidebar-buttons button:hover { background-color: #3a3a3a; }

    /* Dot flashing animasyon stilleri */
    .dot-flashing {
      position: relative;
      width: 10px;
      height: 10px;
      border-radius: 5px;
      background-color: #9880ff;
      color: #9880ff;
      animation: dot-flashing 1s infinite linear alternate;
      animation-delay: 0.5s;
    }
    .dot-flashing::before, .dot-flashing::after {
      content: "";
      display: inline-block;
      position: absolute;
      top: 0;
    }
    .dot-flashing::before {
      left: -15px;
      width: 10px;
      height: 10px;
      border-radius: 5px;
      background-color: #9880ff;
      color: #9880ff;
      animation: dot-flashing 1s infinite alternate;
      animation-delay: 0s;
    }
    .dot-flashing::after {
      left: 15px;
      width: 10px;
      height: 10px;
      border-radius: 5px;
      background-color: #9880ff;
      color: #9880ff;
      animation: dot-flashing 1s infinite alternate;
      animation-delay: 1s;
    }
    @keyframes dot-flashing {
      0% { background-color: #9880ff; }
      50%, 100% { background-color: #ebe6ff; }
    }
  </style>
</head>
<body class="bg-gray-950 text-gray-100 flex min-h-screen">
  <button id="menuToggleBtn">â˜°</button>
  <div id="sidebar" class="sidebar">
    <div class="sidebar-buttons">
      <button onclick="newChat()">+ Yeni Sohbet</button>
      <button onclick="clearMessages()">ðŸ—‘ Temizle</button>
    </div>
  </div>

  <div class="bg-gray-900 rounded-2xl shadow-2xl flex-1 flex flex-col h-[90vh] overflow-hidden m-4 lg:m-8">
    <header class="p-6 bg-gray-800 rounded-t-2xl flex items-center justify-between">
      <h1 class="text-4xl font-extrabold text-white tracking-tight">Eywallah AI <span class="text-emerald-400">Orion 1</span></h1>
    </header>

    <main class="flex-1 flex overflow-hidden">
      <div id="chatArea" class="flex-1 flex flex-col p-6 overflow-y-auto scrollbar-thin"></div>
    </main>

    <div class="p-6 bg-gray-800 rounded-b-2xl flex items-center border-t border-gray-700">
      <input type="text" id="userInput" placeholder="MesajÄ±nÄ±zÄ± buraya yazÄ±n..."
        class="flex-1 bg-gray-700 text-gray-100 placeholder-gray-400 p-3 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all duration-200 text-lg" />
      <button onclick="handleSend(event)"
        class="ml-4 bg-emerald-500 hover:bg-emerald-600 text-gray-900 font-semibold py-3 px-6 rounded-xl shadow-lg transition-all duration-300 transform hover:scale-105">GÃ¶nder</button>
    </div>
  </div>

  <script>
    const chatArea = document.getElementById('chatArea');
    const userInput = document.getElementById('userInput');
    
    function toggleMenu() {
      document.getElementById('sidebar').classList.toggle('open');
    }

    function newChat() {
      localStorage.removeItem('messages');
      displayMessages();
    }

    function clearMessages() {
      if (confirm('TÃ¼m mesajlar silinsin mi?')) {
        localStorage.removeItem('messages');
        displayMessages();
      }
    }

    function displayMessages() {
      chatArea.innerHTML = '';
      const messages = JSON.parse(localStorage.getItem('messages')) || [];
      messages.forEach(msg => {
        const div = document.createElement('div');
        div.className = `flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'} mb-4`;
        div.innerHTML = `<div class="${msg.sender === 'user' ? 'bg-emerald-600 text-white' : 'bg-gray-700 text-gray-200'} p-3 rounded-xl max-w-xs shadow-md">${msg.text}</div>`;
        chatArea.appendChild(div);
      });
    }

    function saveMessage(sender, text) {
      const messages = JSON.parse(localStorage.getItem('messages')) || [];
      messages.push({ sender, text });
      localStorage.setItem('messages', JSON.stringify(messages));
    }
    
    // YazÄ±m animasyonunu sohbet alanÄ±na ekleyen fonksiyon
    function displayTypingIndicator() {
      const div = document.createElement('div');
      div.id = 'typingIndicator';
      div.className = 'flex justify-start mb-4';
      div.innerHTML = `
        <div class="bg-gray-700 p-3 rounded-xl max-w-xs shadow-md flex items-center space-x-2">
          <div class="dot-flashing"></div>
          <span class="text-gray-400 italic">YazÄ±yor...</span>
        </div>
      `;
      chatArea.appendChild(div);
      chatArea.scrollTop = chatArea.scrollHeight;
    }

    // YazÄ±m animasyonunu kaldÄ±ran fonksiyon
    function removeTypingIndicator() {
      const indicator = document.getElementById('typingIndicator');
      if (indicator) {
        indicator.remove();
      }
    }

    async function getAIResponse(prompt) {
      displayTypingIndicator();
      try {
        const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer Eywallah_AI_Orion' // API anahtarÄ±nÄ±zÄ± buraya yazÄ±n
          },
          body: JSON.stringify({
            model: 'deepseek/deepseek-r1-0528-qwen3-8b',
            messages: [{ role: 'user', content: prompt }]
          })
        });

        const data = await response.json();
        const aiReply = data.choices?.[0]?.message?.content || 'Hata: AI cevap veremedi';
        removeTypingIndicator();
        saveMessage('ai', aiReply);
        displayMessages();
      } catch (err) {
        console.error('AI HatasÄ±:', err);
        removeTypingIndicator();
        saveMessage('ai', 'Sunucuyla baÄŸlantÄ± kurulamadÄ±.');
        displayMessages();
      }
    }

    function handleSend(e) {
      e.preventDefault();
      const text = userInput.value.trim();
      if (!text) return;
      saveMessage('user', text);
      displayMessages();
      getAIResponse(text);
      userInput.value = '';
    }

    // Enter tuÅŸunu dinleyen event listener eklendi
    userInput.addEventListener('keypress', function(event) {
        // 'Enter' tuÅŸunun basÄ±lÄ±p basÄ±lmadÄ±ÄŸÄ±nÄ± kontrol et
        if (event.key === 'Enter') {
            event.preventDefault(); // VarsayÄ±lan davranÄ±ÅŸÄ± (yeni satÄ±r ekleme) engelle
            handleSend(event); // Mesaj gÃ¶nderme fonksiyonunu Ã§aÄŸÄ±r
        }
    });

    window.onload = displayMessages;
  </script>
</body>
</html>
